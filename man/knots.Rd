% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/knots.R
\name{knots}
\alias{knots}
\title{Select knot positions for natural cubic splines}
\usage{
knots(x, strategy = "harrell", n_knots = NULL)
}
\arguments{
\item{x}{A numeric vector of data values. NA values are automatically removed.}

\item{strategy}{Character string specifying the knot placement strategy.
Currently only 'harrell' is supported.}

\item{n_knots}{Optional integer to manually override the number of knots.
If NULL (default), the number is determined by Harrell's sample-size-based
rules. Must be at least 1 and should typically not exceed 10.}
}
\value{
A numeric vector of knot positions (quantile values from x), sorted
  in ascending order.
}
\description{
This function selects knot positions for use with natural cubic splines
(e.g., splines::ns()) using recommended quantile-based strategies. By default,
it implements Frank Harrell's approach which selects both the number and
positions of knots based on sample size to balance flexibility and stability.
}
\details{
The 'harrell' strategy implements Frank Harrell's recommendations for knot
selection, which place knots at specific quantiles of the data:

\itemize{
  \item n < 100: 3 knots at quantiles 0.10, 0.50, 0.90
  \item 100 <= n <= 200: 4 knots at quantiles 0.05, 0.35, 0.65, 0.95
  \item n > 200: 5 knots at quantiles 0.05, 0.275, 0.50, 0.725, 0.95
}

where n is the number of non-NA values in x. This approach avoids overfitting
by using relatively few knots while placing them at informative locations
in the distribution.

When n_knots is specified, it overrides the automatic selection and uses
evenly-spaced quantiles from 0 to 1 (excluding endpoints).
}
\examples{
# Small sample: returns 3 knots
set.seed(123)
x_small <- rnorm(50)
knots(x_small)

# Medium sample: returns 4 knots
x_medium <- rnorm(150)
knots(x_medium)

# Large sample: returns 5 knots
x_large <- rnorm(300)
knots(x_large)

# Manual override
knots(x_small, n_knots = 4)

# Use with splines::ns()
library(splines)
age <- runif(200, 18, 80)
age_knots <- knots(age)
age_spline <- ns(age, knots = age_knots)

}
\references{
Harrell, F. E. (2015). Regression Modeling Strategies: With Applications to
Linear Models, Logistic and Ordinal Regression, and Survival Analysis
(2nd ed.). Springer.
}
